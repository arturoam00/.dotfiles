#!/bin/sh

# set -e 

DCONF_BACKUP_FILE="$HOME/.config/dconf/user.conf"
BU_CONFIG_DIR="$HOME/.config/backup"

SOURCE="/"
DEST="$(find /media /mnt -maxdepth 2 -mindepth 1 | fzf)"

# Save current dconf database
dconf dump / > $DCONF_BACKUP_FILE

# Make sure librewolf is not running
killall librewolf > /dev/null

# Back up
sudo rsync -arPv --delete --files-from="$BU_CONFIG_DIR/include.txt" --exclude-from="$BU_CONFIG_DIR/exclude.txt" $SOURCE $DEST
